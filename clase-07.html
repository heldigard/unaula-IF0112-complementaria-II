<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Clase 7: Conectividad WiFi | IF0112</title>
    <style>

        /* ============================================
           DESIGN SYSTEM - Spacing Scale (8px base)
           ============================================ */
        :root {
            /* Spacing scale */
            --space-1: 0.25rem;  /* 4px */
            --space-2: 0.5rem;   /* 8px */
            --space-3: 0.75rem;  /* 12px */
            --space-4: 1rem;     /* 16px */
            --space-5: 1.25rem;  /* 20px */
            --space-6: 1.5rem;   /* 24px */
            --space-8: 2rem;     /* 32px */
            --space-10: 2.5rem;  /* 40px */
            --space-12: 3rem;    /* 48px */

            /* Typography scale */
            --text-xs: 0.75rem;    /* 12px */
            --text-sm: 0.875rem;   /* 14px */
            --text-base: 1rem;     /* 16px */
            --text-lg: 1.125rem;   /* 18px */
            --text-xl: 1.25rem;    /* 20px */
            --text-2xl: 1.5rem;    /* 24px */
            --text-3xl: 1.875rem;  /* 30px */
            --text-4xl: 2.25rem;   /* 36px */

            /* Line heights */
            --leading-tight: 1.25;
            --leading-snug: 1.375;
            --leading-normal: 1.5;
            --leading-relaxed: 1.625;
            --leading-loose: 2;

            /* Colors - improved accessibility */
            --color-primary: #1e40af;
            --color-primary-light: #3b82f6;
            --color-secondary: #0f172a;
            --color-accent: #f59e0b;

            /* Text colors - WCAG AA compliant */
            --text-primary: #0f172a;      /* #0f172a on white = 16.4:1 */
            --text-secondary: #334155;    /* #334155 on white = 9.8:1 */
            --text-muted: #64748b;        /* #64748b on white = 5.1:1 */
            --text-inverse: #ffffff;

            /* Background colors */
            --bg-primary: #ffffff;
            --bg-secondary: #f8fafc;
            --bg-tertiary: #f1f5f9;

            /* Border colors */
            --border-light: #e2e8f0;
            --border-medium: #cbd5e1;

            /* Shadows */
            --shadow-sm: 0 1px 2px rgba(0,0,0,0.05);
            --shadow-md: 0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0,0,0,0.1), 0 4px 6px -2px rgba(0,0,0,0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0,0,0,0.1), 0 10px 10px -5px rgba(0,0,0,0.04);

            /* Border radius */
            --radius-sm: 0.25rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
        }

        /* ============================================
           RESET & BASE STYLES
           ============================================ */
        *, *::before, *::after {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            scroll-behavior: smooth;
            font-size: 16px;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            line-height: var(--leading-normal);
            color: var(--text-primary);
            background: var(--bg-tertiary);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* ============================================
           LAYOUT
           ============================================ */
        .container {
            max-width: 1280px;
            margin: 0 auto;
            background: var(--bg-primary);
            box-shadow: var(--shadow-xl);
        }

        /* ============================================
           HEADER
           ============================================ */
        header {
            background: linear-gradient(135deg, var(--color-primary) 0%, var(--color-primary-light) 100%);
            color: var(--text-inverse);
            padding: var(--space-8) var(--space-6);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        header::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -10%;
            width: 400px;
            height: 400px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            pointer-events: none;
        }

        header h1 {
            font-size: var(--text-4xl);
            font-weight: 700;
            margin-bottom: var(--space-2);
            line-height: var(--leading-tight);
            position: relative;
            z-index: 1;
        }

        header .subtitle {
            font-size: var(--text-lg);
            opacity: 0.95;
            font-weight: 400;
        }

        header .meta {
            margin-top: var(--space-4);
            font-size: var(--text-sm);
            opacity: 0.85;
            display: inline-flex;
            align-items: center;
            gap: var(--space-3);
            flex-wrap: wrap;
            justify-content: center;
        }

        header .meta span {
            padding: var(--space-1) var(--space-3);
            background: rgba(255,255,255,0.15);
            border-radius: var(--radius-lg);
        }

        /* ============================================
           NAVIGATION - Enhanced
           ============================================ */
        nav {
            background: var(--color-secondary);
            position: sticky;
            top: 0;
            z-index: 100;
            box-shadow: var(--shadow-md);
        }

        nav ul {
            list-style: none;
            display: flex;
            flex-wrap: wrap;
            padding: 0 var(--space-4);
            max-width: 100%;
            overflow-x: auto;
        }

        nav li {
            margin: 0;
        }

        nav a {
            display: block;
            padding: var(--space-3) var(--space-4);
            color: rgba(255,255,255,0.85);
            text-decoration: none;
            transition: all 0.2s ease;
            font-size: var(--text-sm);
            font-weight: 500;
            white-space: nowrap;
            border-bottom: 2px solid transparent;
        }

        nav a:hover {
            background: rgba(255,255,255,0.1);
            color: var(--text-inverse);
        }

        nav a:focus {
            outline: 2px solid var(--color-accent);
            outline-offset: -2px;
        }

        /* Progress indicator */
        .progress-bar {
            height: 3px;
            background: rgba(255,255,255,0.2);
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--color-accent), #fbbf24);
            width: 0%;
            transition: width 0.3s ease;
        }

        /* ============================================
           MAIN CONTENT
           ============================================ */
        main {
            padding: var(--space-8);
            max-width: 1024px;
            margin: 0 auto;
        }

        section {
            margin-bottom: var(--space-12);
            scroll-margin-top: 80px;
            scroll-margin-block: 80px;
        }

        /* ============================================
           TYPOGRAPHY HIERARCHY
           ============================================ */
        section h2 {
            color: var(--color-primary);
            border-bottom: 3px solid var(--color-primary-light);
            padding-bottom: var(--space-2);
            margin-bottom: var(--space-6);
            font-size: var(--text-3xl);
            font-weight: 700;
            line-height: var(--leading-tight);
        }

        section h3 {
            color: var(--color-primary);
            margin: var(--space-6) 0 var(--space-4);
            font-size: var(--text-2xl);
            font-weight: 600;
            line-height: var(--leading-snug);
        }

        section h4 {
            color: var(--text-secondary);
            margin: var(--space-4) 0 var(--space-2);
            font-size: var(--text-lg);
            font-weight: 600;
        }

        section h5 {
            color: var(--text-secondary);
            margin: var(--space-3) 0 var(--space-2);
            font-size: var(--text-base);
            font-weight: 600;
        }

        p {
            margin-bottom: var(--space-4);
            text-align: justify;
            line-height: var(--leading-relaxed);
            max-width: 75ch;
        }

        /* ============================================
           CALLOUT BOXES
           ============================================ */
        .intro-box {
            background: #eff6ff;
            border-left: 4px solid var(--color-primary-light);
            padding: var(--space-5);
            margin: var(--space-6) 0;
            border-radius: 0 var(--radius-lg) var(--radius-lg) 0;
            box-shadow: var(--shadow-sm);
        }

        .intro-box strong {
            color: var(--color-primary);
            font-weight: 600;
        }

        .example-box {
            background: #fef3c7;
            border-left: 4px solid var(--color-accent);
            padding: var(--space-5);
            margin: var(--space-5) 0;
            border-radius: 0 var(--radius-lg) var(--radius-lg) 0;
            box-shadow: var(--shadow-sm);
        }

        .alert-box {
            background: #fee2e2;
            border-left: 4px solid #ef4444;
            padding: var(--space-5);
            margin: var(--space-5) 0;
            border-radius: 0 var(--radius-lg) var(--radius-lg) 0;
            box-shadow: var(--shadow-sm);
        }

        /* ============================================
           TABLES - Enhanced
           ============================================ */
        table {
            width: 100%;
            border-collapse: collapse;
            margin: var(--space-6) 0;
            font-size: var(--text-sm);
            border-radius: var(--radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-md);
        }

        th {
            background: var(--color-primary);
            color: var(--text-inverse);
            padding: var(--space-3) var(--space-4);
            text-align: left;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.025em;
            font-size: var(--text-xs);
        }

        td {
            padding: var(--space-3) var(--space-4);
            border-bottom: 1px solid var(--border-light);
        }

        tbody tr:nth-child(even) {
            background: var(--bg-secondary);
        }

        tbody tr:hover {
            background: #e0e7ff;
            transition: background 0.15s ease;
        }

        /* Responsive tables */
        @media (max-width: 768px) {
            table {
                font-size: var(--text-xs);
            }
            th, td {
                padding: var(--space-2) var(--space-3);
            }
        }

        /* ============================================
           GRIDS
           ============================================ */
        .grid-2 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
            gap: var(--space-6);
            margin: var(--space-6) 0;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
            gap: var(--space-5);
            margin: var(--space-6) 0;
        }

        /* ============================================
           CARDS - Enhanced
           ============================================ */
        .card {
            background: var(--bg-primary);
            border-radius: var(--radius-lg);
            padding: var(--space-6);
            border: 1px solid var(--border-light);
            box-shadow: var(--shadow-sm);
            transition: all 0.2s ease;
        }

        .card:hover {
            box-shadow: var(--shadow-md);
            transform: translateY(-2px);
        }

        .card h4 {
            color: var(--color-primary);
            margin-bottom: var(--space-2);
            font-size: var(--text-lg);
        }

        .card-blue { background: #eff6ff; border-color: #bfdbfe; }
        .card-green { background: #f0fdf4; border-color: #bbf7d0; }
        .card-yellow { background: #fef3c7; border-color: #fde68a; }
        .card-pink { background: #fdf2f8; border-color: #fbcfe8; }

        /* ============================================
           FLOW DIAGRAM
           ============================================ */
        .flow-diagram {
            display: flex;
            flex-wrap: wrap;
            gap: var(--space-3);
            align-items: center;
            margin: var(--space-8) 0;
            justify-content: center;
        }

        .flow-step {
            background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
            color: white;
            padding: var(--space-4) var(--space-5);
            border-radius: var(--radius-lg);
            text-align: center;
            flex: 0 0 auto;
            min-width: 150px;
            font-size: var(--text-base);
            font-weight: 500;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            border: 2px solid #1d4ed8;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .flow-step:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 12px -1px rgba(0, 0, 0, 0.15), 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        .flow-step strong {
            display: block;
            font-size: var(--text-lg);
            margin-bottom: var(--space-1);
        }

        .flow-step small {
            color: rgba(255, 255, 255, 0.9);
            font-size: var(--text-sm);
        }

        .flow-arrow {
            font-size: var(--text-3xl);
            color: #1d4ed8;
            font-weight: bold;
            flex: 0 0 auto;
        }

        /* ============================================
           TIMELINE
           ============================================ */
        .timeline {
            position: relative;
            padding-left: var(--space-8);
            margin: var(--space-6) 0;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 0;
            top: var(--space-2);
            bottom: var(--space-2);
            width: 3px;
            background: linear-gradient(to bottom, var(--color-primary-light), var(--color-primary));
            border-radius: 2px;
        }

        .timeline-item {
            margin-bottom: var(--space-6);
            position: relative;
        }

        .timeline-item::before {
            content: '';
            position: absolute;
            left: calc(-1 * var(--space-8) - 5px);
            top: var(--space-2);
            width: 14px;
            height: 14px;
            background: var(--color-primary-light);
            border-radius: 50%;
            border: 3px solid var(--bg-primary);
            box-shadow: 0 0 0 3px var(--color-primary-light);
        }

        /* ============================================
           CODE BLOCKS
           ============================================ */
        pre {
            background: var(--color-secondary);
            color: #e2e8f0;
            padding: var(--space-4);
            border-radius: var(--radius-lg);
            overflow-x: auto;
            margin: var(--space-4) 0;
            font-size: var(--text-sm);
            line-height: var(--leading-relaxed);
            box-shadow: var(--shadow-md);
        }

        code {
            background: var(--bg-tertiary);
            color: var(--color-primary);
            padding: var(--space-1) var(--space-2);
            border-radius: var(--radius-md);
            font-size: 0.9em;
            font-weight: 500;
        }

        pre code {
            background: transparent;
            padding: 0;
            color: inherit;
        }

        /* ============================================
           FIGURES
           ============================================ */
        figure {
            margin: var(--space-8) 0;
            text-align: center;
        }

        figure img {
            max-width: 100%;
            height: auto;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
        }

        figcaption {
            margin-top: var(--space-3);
            font-size: var(--text-sm);
            color: var(--text-muted);
            font-style: italic;
            line-height: var(--leading-relaxed);
        }

        /* ============================================
           LISTS
           ============================================ */
        ul, ol {
            margin-left: var(--space-6);
            margin-bottom: var(--space-4);
        }

        li {
            margin-bottom: var(--space-2);
            line-height: var(--leading-relaxed);
        }

        /* ============================================
           SPECIAL TABLES
           ============================================ */
        .competencies-table th:first-child,
        .competencies-table td:first-child {
            width: 20%;
            text-align: center;
            font-size: var(--text-3xl);
        }

        .eras-table td:first-child {
            font-weight: 700;
            color: var(--color-primary);
        }

        /* ============================================
           BACK TO TOP BUTTON
           ============================================ */
        .back-to-top {
            position: fixed;
            bottom: var(--space-6);
            right: var(--space-6);
            background: var(--color-primary);
            color: var(--text-inverse);
            width: 48px;
            height: 48px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
            box-shadow: var(--shadow-lg);
            border: none;
            font-size: var(--text-xl);
            z-index: 99;
        }

        .back-to-top.visible {
            opacity: 1;
            visibility: visible;
        }

        .back-to-top:hover {
            background: var(--color-primary-light);
            transform: translateY(-2px);
        }

        .back-to-top:focus {
            outline: 3px solid var(--color-accent);
            outline-offset: 2px;
        }

        /* ============================================
           FOOTER
           ============================================ */
        footer {
            background: var(--color-secondary);
            color: var(--text-inverse);
            text-align: center;
            padding: var(--space-8) var(--space-6);
            margin-top: var(--space-12);
        }

        footer p {
            margin: var(--space-2) 0;
            text-align: center;
            color: rgba(255,255,255,0.85);
        }

        /* ============================================
           RESPONSIVE DESIGN
           ============================================ */
        @media (max-width: 1024px) {
            main { padding: var(--space-6); }
        }

        @media (max-width: 768px) {
            header {
                padding: var(--space-6) var(--space-4);
            }
            header h1 {
                font-size: var(--text-3xl);
            }
            header .subtitle {
                font-size: var(--text-base);
            }
            .grid-2, .grid-3 {
                grid-template-columns: 1fr;
            }
            nav {
                position: relative;
            }
            nav ul {
                flex-direction: column;
                padding: 0;
            }
            nav a {
                padding: var(--space-3) var(--space-4);
                border-bottom: 1px solid rgba(255,255,255,0.1);
            }
            main {
                padding: var(--space-4);
            }
            section {
                margin-bottom: var(--space-10);
            }
            section h2 {
                font-size: var(--text-2xl);
            }
            .back-to-top {
                bottom: var(--space-4);
                right: var(--space-4);
                width: 44px;
                height: 44px;
            }
        }

        @media (max-width: 480px) {
            html {
                font-size: 14px;
            }
            header h1 {
                font-size: var(--text-2xl);
            }
            .flow-step {
                min-width: 120px;
                font-size: var(--text-sm);
                padding: var(--space-3) var(--space-4);
            }
            .flow-step strong {
                font-size: var(--text-base);
            }
            .flow-arrow {
                font-size: var(--text-2xl);
            }
        }

        /* ============================================
           ACCESSIBILITY ENHANCEMENTS
           ============================================ */
        @media (prefers-reduced-motion: reduce) {
            *, *::before, *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        :focus-visible {
            outline: 3px solid var(--color-accent);
            outline-offset: 2px;
        }

        /* Skip link for keyboard users */
        .skip-link {
            position: absolute;
            top: -100px;
            left: 0;
            background: var(--color-primary);
            color: var(--text-inverse);
            padding: var(--space-2) var(--space-4);
            z-index: 999;
            text-decoration: none;
            font-weight: 600;
        }

        .skip-link:focus {
            top: 0;
        }

        /* Print styles */
        @media print {
            nav, .back-to-top, .progress-bar {
                display: none;
            }
            body {
                background: white;
            }
            .container {
                box-shadow: none;
            }
        }
    
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Clase 7: Conectividad WiFi</h1>
            <p class="subtitle">ESP32 como Dispositivo Conectado</p>
            <p class="meta">
                IF0112 - Complementaria II (IoT) | 6¬∞ Semestre - Ingenier√≠a Inform√°tica | UNAULA
            </p>
        </header>

        <nav>
            <ul>
                <li><a href="#objetivos">Objetivos</a></li>
                <li><a href="#modos">Modos WiFi</a></li>
                <li><a href="#conexion">Conexi√≥n STA</a></li>
                <li><a href="#reconexion">Reconexi√≥n</a></li>
                <li><a href="#servidor">Servidor Web</a></li>
                <li><a href="#api">API REST</a></li>
                <li><a href="#nube">ThingSpeak</a></li>
                <li><a href="#proyecto">Proyecto</a></li>
                <li><a href="#seguridad">Seguridad</a></li>
                <li><a href="#energia">Ahorro Energ√≠a</a></li>
            </ul>
            <div class="progress-bar">
                <div class="progress-fill" id="progressFill"></div>
            </div>
        </nav>

        <!-- Back to top button -->
        <button class="back-to-top" id="backToTop" aria-label="Volver arriba">‚Üë</button>

        <main>
            <!-- Objetivos -->
            <section id="objetivos">
                <h2>Objetivos de la Clase</h2>

                <div class="grid-2">
                    <div>
                        <h3>Competencias a Desarrollar</h3>
                        <p>Al finalizar esta clase, podr√°:</p>
                        <ul>
                            <li><strong>Conectar</strong> ESP32 a red WiFi existente (modo STA)</li>
                            <li><strong>Crear</strong> punto de acceso (AP) con ESP32</li>
                            <li><strong>Desarrollar</strong> servidor web b√°sico</li>
                            <li><strong>Enviar</strong> datos a servicios en la nube</li>
                            <li><strong>Implementar</strong> reconexi√≥n autom√°tica</li>
                        </ul>
                    </div>
                    <div>
                        <h3>Estructura de la Clase</h3>
                        <table>
                            <thead>
                                <tr>
                                    <th>Bloque</th>
                                    <th>Tema</th>
                                    <th>Duraci√≥n</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>1Ô∏è‚É£</td>
                                    <td>Modos WiFi (STA, AP, Ambos)</td>
                                    <td>25 min</td>
                                </tr>
                                <tr>
                                    <td>2Ô∏è‚É£</td>
                                    <td>Conexi√≥n y reconexi√≥n autom√°tica</td>
                                    <td>30 min</td>
                                </tr>
                                <tr>
                                    <td>3Ô∏è‚É£</td>
                                    <td>Servidor Web y API REST</td>
                                    <td>35 min</td>
                                </tr>
                                <tr>
                                    <td>4Ô∏è‚É£</td>
                                    <td>ThingSpeak y Proyecto</td>
                                    <td>30 min</td>
                                </tr>
                            </tbody>
                        </table>
                        <p class="intro-box"><strong>Total:</strong> 2 horas | <strong>üí° Pregunta clave:</strong> ¬øC√≥mo hacer que un ESP32 sea un ciudadano IoT de primera clase?</p>
                    </div>
                </div>
            </section>

            <!-- Modos WiFi -->
            <section id="modos">
            <h2>üì∂ Modos de Operaci√≥n WiFi</h2>

            <div class="learning-key">
                <h4>üéØ Aprendizaje Clave</h4>
                <p>El ESP32 puede operar en <strong>modo STA</strong> (conectarse a red existente), <strong>modo AP</strong> (crear su propia red), o <strong>ambos simult√°neamente</strong>. La elecci√≥n depende del caso de uso.</p>
            </div>

            <div class="hardware-notice">
                <h4>üíª Nota sobre Factibilidad Windows</h4>
                <p><strong>Todo el c√≥digo puede probarse en simuladores gratuitos</strong> como Wokwi.com, sin necesidad de hardware f√≠sico. El curso IF0112 no obliga compras de equipos.</p>
            </div>
            
            <p>El ESP32 puede operar en diferentes modos WiFi seg√∫n las necesidades del proyecto:</p>
            
            <table>
                <thead>
                    <tr><th>Modo</th><th>Descripci√≥n</th><th>Uso</th></tr>
                </thead>
                <tbody>
                    <tr><td><strong>STA</strong> (Station)</td><td>Se conecta a una red WiFi existente</td><td>Conectar a router/internet</td></tr>
                    <tr><td><strong>AP</strong> (Access Point)</td><td>Crea su propia red WiFi</td><td>Configuraci√≥n inicial, red local</td></tr>
                    <tr><td><strong>STA+AP</strong> (Dual)</td><td>Ambos modos simult√°neamente</td><td>Configuraci√≥n avanzada</td></tr>
                </tbody>
            </table>
            
            <h3>Funciones para Configurar Modos</h3>
            <pre>WiFi.mode(WIFI_STA);      // Modo estaci√≥n
WiFi.mode(WIFI_AP);       // Modo access point
WiFi.mode(WIFI_AP_STA);   // Modo dual

WiFi.softAP(ssid, pass);  // Crear red WiFi
WiFi.softAPIP();          // IP del AP</pre>
        </section>
        
        <!-- Conexi√≥n STA -->
        <section id="conexion">
            <h2>üîó Conexi√≥n WiFi: Modo Estaci√≥n (STA)</h2>

            <div class="learning-key">
                <h4>üéØ Aprendizaje Clave</h4>
                <p>La conexi√≥n WiFi requiere <code>WiFi.begin()</code> con credenciales, verificaci√≥n del estado con <code>WiFi.status()</code>, y manejo de la IP asignada mediante <code>WiFi.localIP()</code>.</p>
            </div>
            
            <h3>C√≥digo B√°sico</h3>
            <pre>#include &lt;WiFi.h&gt;

const char* ssid = "NombreDeTuRed";
const char* password = "ContrasenaDeRed";

void setup() {
  Serial.begin(115200);
  WiFi.begin(ssid, password);

  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }

  Serial.println("‚úì Conectado!");
  Serial.print("IP: ");
  Serial.println(WiFi.localIP());
}

void loop() {}</pre>
            
            <h3>Estados WiFi</h3>
            <table>
                <thead>
                    <tr><th>Estado</th><th>Significado</th></tr>
                </thead>
                <tbody>
                    <tr><td><code>WL_CONNECTED</code></td><td>Conectado</td></tr>
                    <tr><td><code>WL_NO_SSID_AVAIL</code></td><td>Red no encontrada</td></tr>
                    <tr><td><code>WL_CONNECT_FAILED</code></td><td>Contrase√±a incorrecta</td></tr>
                </tbody>
            </table>
            
            <h3>Informaci√≥n de Red</h3>
            <table>
                <thead>
                    <tr><th>Funci√≥n</th><th>Retorna</th></tr>
                </thead>
                <tbody>
                    <tr><td><code>WiFi.localIP()</code></td><td>IP local asignada</td></tr>
                    <tr><td><code>WiFi.subnetMask()</code></td><td>M√°scara de subred</td></tr>
                    <tr><td><code>WiFi.gatewayIP()</code></td><td>Gateway</td></tr>
                    <tr><td><code>WiFi.RSSI()</code></td><td>Se√±al en dBm</td></tr>
                    <tr><td><code>WiFi.macAddress()</code></td><td>Direcci√≥n MAC</td></tr>
                </tbody>
            </table>
        </section>
        
        <!-- Reconexi√≥n -->
        <section id="reconexion">
            <h2>üîÑ Reconexi√≥n Autom√°tica WiFi</h2>

            <div class="learning-key">
                <h4>üéØ Aprendizaje Clave</h4>
                <p>Las redes WiFi pueden fallar. Implementar <strong>reconexi√≥n autom√°tica</strong> con <code>millis()</code> es esencial para sistemas IoT robustos que operan 24/7 sin intervenci√≥n humana.</p>
            </div>
            
            <div class="info-box warning">
                <h4>‚ö†Ô∏è El Problema</h4>
                <p>Las redes WiFi pueden perder se√±al temporalmente, reiniciarse por apagones o mantenimiento, o saturarse y desconectar dispositivos. <strong>Sin reconexi√≥n autom√°tica:</strong> El ESP32 queda "colgado" sin conexi√≥n hasta reiniciarlo manualmente.</p>
            </div>
            
            <h3>Soluci√≥n: Verificaci√≥n Peri√≥dica</h3>
            <pre>#include &lt;WiFi.h&gt;

const char* ssid = "MiRed";
const char* password = "MiClave";

unsigned long ultimoIntento = 0;
const long INTERVALO_RECONEXION = 30000; // 30s

void setup() {
    Serial.begin(115200);
    conectarWiFi();
}

void loop() {
    // Verificar conexi√≥n peri√≥dicamente
    if (WiFi.status() != WL_CONNECTED) {
        unsigned long ahora = millis();
        
        if (ahora - ultimoIntento >= INTERVALO_RECONEXION) {
            Serial.println("‚ö†Ô∏è Conexi√≥n perdida. Reconectando...");
            conectarWiFi();
            ultimoIntento = ahora;
        }
    }
    
    // Tu c√≥digo principal aqu√≠
}

void conectarWiFi() {
    WiFi.begin(ssid, password);
    
    int intentos = 0;
    while (WiFi.status() != WL_CONNECTED && intentos < 20) {
        delay(500);
        Serial.print(".");
        intentos++;
    }
    
    if (WiFi.status() == WL_CONNECTED) {
        Serial.println("\n‚úì WiFi conectado!");
    } else {
        Serial.println("\n‚úó Fallo de conexi√≥n");
    }
}</pre>
        </section>
        
        <!-- Servidor Web -->
        <section id="servidor">
            <h2>üåê Crear un Servidor Web en ESP32</h2>

            <div class="learning-key">
                <h4>üéØ Aprendizaje Clave</h4>
                <p>Un servidor web en ESP32 permite <strong>controlar hardware desde cualquier navegador</strong>. Se configuran rutas (endpoints) con <code>server.on()</code> y se atienden peticiones con <code>server.handleClient()</code>.</p>
            </div>
            
            <h3>Conceptos B√°sicos</h3>
            <p>Un <strong>servidor web</strong> en el ESP32 permite mostrar p√°ginas HTML desde el microcontrolador, recibir comandos mediante URLs, exponer una API REST, y controlar hardware desde el navegador.</p>
            
            <h3>Librer√≠as Necesarias</h3>
            <pre>#include &lt;WiFi.h&gt;
#include &lt;WebServer.h&gt;  // Servidor web

// Crear servidor en puerto 80 (HTTP)
WebServer server(80);</pre>
            
            <h3>Configuraci√≥n del Servidor</h3>
            <pre>void setup() {
    // Conectar WiFi...
    
    // Definir rutas (endpoints)
    server.on("/", handleRoot);
    server.on("/led/on", handleLedOn);
    server.on("/led/off", handleLedOff);

    // Iniciar servidor
    server.begin();
    Serial.println("Servidor iniciado");
}

void loop() {
    // Atender peticiones de clientes
    server.handleClient();
}</pre>
            
            <h3>Manejadores de Rutas</h3>
            <pre>const int LED_PIN = 2;

// P√°gina principal
void handleRoot() {
    String html = "&lt;html&gt;&lt;body&gt;";
    html += "&lt;h1&gt;Control ESP32&lt;/h1&gt;";
    html += "&lt;a href='/led/on'&gt;Encender LED&lt;/a&gt;&lt;br&gt;";
    html += "&lt;a href='/led/off'&gt;Apagar LED&lt;/a&gt;";
    html += "&lt;/body&gt;&lt;/html&gt;";

    server.send(200, "text/html", html);
}

// Encender LED
void handleLedOn() {
    digitalWrite(LED_PIN, HIGH);
    server.sendHeader("Location", "/");
    server.send(303);  // Redirect
}

// Apagar LED
void handleLedOff() {
    digitalWrite(LED_PIN, LOW);
    server.sendHeader("Location", "/");
    server.send(303);
}</pre>
        </section>
        
        <!-- API REST -->
        <section id="api">
            <h2>üìä API REST con JSON</h2>

            <div class="learning-key">
                <h4>üéØ Aprendizaje Clave</h4>
                <p>Las APIs REST permiten que <strong>m√°quinas se comuniquen entre s√≠</strong> usando HTTP y JSON. El ESP32 puede exponer datos de sensores mediante endpoints que devuelven JSON.</p>
            </div>
            
            <h3>¬øQu√© es una API REST?</h3>
            <p><strong>API</strong> (Application Programming Interface): Interfaz para que programas se comuniquen.<br>
            <strong>REST</strong> (Representational State Transfer): Estilo de arquitectura usando HTTP.</p>
            
            <h3>M√©todos HTTP Comunes</h3>
            <table>
                <thead>
                    <tr><th>M√©todo</th><th>Acci√≥n</th><th>Ejemplo</th></tr>
                </thead>
                <tbody>
                    <tr><td>GET</td><td>Obtener datos</td><td><code>/api/sensores</code></td></tr>
                    <tr><td>POST</td><td>Crear/enviar datos</td><td><code>/api/datos</code></td></tr>
                    <tr><td>PUT</td><td>Actualizar datos</td><td><code>/api/config</code></td></tr>
                    <tr><td>DELETE</td><td>Eliminar datos</td><td><code>/api/alarma</code></td></tr>
                </tbody>
            </table>
            
            <h3>C√≥digo: API REST en ESP32</h3>
            <pre>#include &lt;ArduinoJson.h&gt;  // Librer√≠a JSON

void handleSensorData() {
    // Leer sensores reales
    float temperatura = dht.readTemperature();
    float humedad = dht.readHumidity();
    
    // Crear documento JSON
    StaticJsonDocument&lt;200&gt; doc;
    doc["temperatura"] = temperatura;
    doc["humedad"] = humedad;
    doc["timestamp"] = millis();
    doc["dispositivo"] = "ESP32-Sala";
    
    // Serializar a String
    String jsonResponse;
    serializeJson(doc, jsonResponse);
    
    // Enviar respuesta
    server.send(200, "application/json", jsonResponse);
}</pre>
            
            <h3>Respuesta JSON</h3>
            <pre>{
  "temperatura": 24.5,
  "humedad": 60,
  "timestamp": 12456789,
  "dispositivo": "ESP32-Sala"
}</pre>
        </section>
        
        <!-- Nube -->
        <section id="nube">
            <h2>‚òÅÔ∏è ThingSpeak: Plataforma IoT Gratuita</h2>

            <div class="learning-key">
                <h4>üéØ Aprendizaje Clave</h4>
                <p>ThingSpeak es una plataforma gratuita para <strong>almacenar y visualizar datos IoT</strong>. Usa HTTP GET simple, permitiendo enviar datos desde ESP32 sin librer√≠as complejas.</p>
            </div>
            
            <div class="tech-grid">
                <div class="tech-card">
                    <h4>¬øQu√© es ThingSpeak?</h4>
                    <ul>
                        <li>Almacenar datos de sensores</li>
                        <li>Visualizar datos en gr√°ficos</li>
                        <li>Analizar datos con MATLAB</li>
                        <li>Activar alertas</li>
                        <li>API simple basada en HTTP</li>
                    </ul>
                </div>
                <div class="tech-card">
                    <h4>Configuraci√≥n</h4>
                    <ol>
                        <li>Crear cuenta en thingspeak.com</li>
                        <li>Crear un nuevo "Channel"</li>
                        <li>Configurar campos:
                            <ul>
                                <li>Field 1: Temperatura</li>
                                <li>Field 2: Humedad</li>
                            </ul>
                        </li>
                        <li>Obtener Write API Key</li>
                    </ol>
                </div>
            </div>
            
            <h3>C√≥digo para ThingSpeak</h3>
            <pre>#include &lt;HTTPClient.h&gt;

const char* apiKey = "TU_API_KEY_AQUI";  // Write API Key

void enviarAThingSpeak(float temp, float hum) {
    if (WiFi.status() != WL_CONNECTED) {
        Serial.println("Sin WiFi");
        return;
    }
    
    HTTPClient http;
    
    // Construir URL
    String url = "http://api.thingspeak.com/update?api_key=";
    url += apiKey;
    url += "&field1=" + String(temp);   // Temperatura
    url += "&field2=" + String(hum);    // Humedad
    
    http.begin(url);
    int httpCode = http.GET();
    
    if (httpCode == 200) {
        String respuesta = http.getString();
        Serial.println("‚úì Datos enviados. Entry: " + respuesta);
    } else {
        Serial.println("‚úó Error: " + String(httpCode));
    }
    
    http.end();
}

// IMPORTANTE: ThingSpeak permite enviar datos cada 15 segundos (m√≠nimo en cuenta gratuita)</pre>
        </section>
        
        <!-- Proyecto -->
        <section id="proyecto">
            <h2>üå§Ô∏è Proyecto Integrador: Estaci√≥n Meteorol√≥gica Web</h2>

            <div class="learning-key">
                <h4>üéØ Aprendizaje Clave</h4>
                <p>Integrar WiFi + servidor web + sensores crea un <strong>sistema IoT completo</strong>. El ESP32 lee datos, sirve una p√°gina HTML, y actualiza informaci√≥n en tiempo real.</p>
            </div>

            <div class="hardware-notice">
                <h4>üîß Opciones para Realizar el Proyecto</h4>
                <p><strong>Opci√≥n A (Simulador - Recomendado):</strong> Wokwi.com permite simular ESP32 con WiFi, DHT11 y servidor web completo. Gratuito.<br><br>
                <strong>Opci√≥n B (Demo Docente):</strong> El profesor demuestra el sistema en clase.<br><br>
                <strong>Opci√≥n C:</strong> Usar hardware solo si ya se dispone de √©l.</p>
            </div>
            
            <h3>Descripci√≥n</h3>
            <p>Estaci√≥n meteorol√≥gica con sensor DHT11, servidor web integrado, dashboard visual y actualizaci√≥n autom√°tica.</p>
            
            <h3>Componentes</h3>
            <table>
                <thead>
                    <tr><th>Componente</th><th>Pin ESP32</th></tr>
                </thead>
                <tbody>
                    <tr><td>DHT11</td><td>GPIO4</td></tr>
                    <tr><td>LED Status</td><td>GPIO2</td></tr>
                </tbody>
            </table>
            
            <div class="arch-diagram">
                <h4>Arquitectura del Sistema</h4>
                <div class="arch-layer">
                    <div class="arch-layer-title">üì• CAPA DE SENSORES</div>
                    <p>DHT11 lee temperatura y humedad ‚Üí GPIO4</p>
                </div>
                <div class="arch-layer">
                    <div class="arch-layer-title">‚öôÔ∏è CAPA DE PROCESAMIENTO</div>
                    <p>ESP32: Lee datos + Servidor web en puerto 80</p>
                </div>
                <div class="arch-layer">
                    <div class="arch-layer-title">üì° CAPA DE CONECTIVIDAD</div>
                    <p>WiFi conexi√≥n a red local, IP asignada por DHCP</p>
                </div>
                <div class="arch-layer">
                    <div class="arch-layer-title">üñ•Ô∏è CAPA DE USUARIO</div>
                    <p>Navegador web con dashboard y auto-refresh cada 5s</p>
                </div>
            </div>
            
            <h3>C√≥digo Completo</h3>
            <pre>#include &lt;WiFi.h&gt;
#include &lt;WebServer.h&gt;
#include "DHT.h"

const char* ssid = "TU_RED_WIFI";
const char* password = "TU_PASSWORD";

const int DHT_PIN = 4;
DHT dht(DHT_PIN, DHT11);
WebServer server(80);

float temperatura = 0;
float humedad = 0;
unsigned long ultimaLectura = 0;

void setup() {
  Serial.begin(115200);
  dht.begin();

  WiFi.begin(ssid, password);
  while (WiFi.status() != WL_CONNECTED) {
    delay(500);
    Serial.print(".");
  }
  Serial.println(WiFi.localIP());

  server.on("/", handleRoot);
  server.on("/api/datos", handleApiDatos);
  server.begin();
}

void loop() {
  // Leer cada 2s
  if (millis() - ultimaLectura > 2000) {
    temperatura = dht.readTemperature();
    humedad = dht.readHumidity();
    ultimaLectura = millis();
  }
  server.handleClient();
}

void handleRoot() {
  String html = "&lt;html&gt;&lt;head&gt;";
  html += "&lt;meta charset='UTF-8'&gt;";
  html += "&lt;style&gt;body{font-family:Arial;text-align:center;padding:20px;}";
  html += ".temp{color:#e74c3c;font-size:48px;}";
  html += ".hum{color:#3498db;font-size:48px;}&lt;/style&gt;";
  html += "&lt;/head&gt;&lt;body&gt;";
  html += "&lt;h1&gt;üå§Ô∏è Estaci√≥n Meteorol√≥gica&lt;/h1&gt;";
  html += "&lt;div class='temp'&gt;üå°Ô∏è " + String(temperatura, 1) + "¬∞C&lt;/div&gt;";
  html += "&lt;div class='hum'&gt;üíß " + String(humedad, 1) + "%&lt;/div&gt;";
  html += "&lt;script&gt;setTimeout(()=&gt;location.reload(),5000);&lt;/script&gt;";
  html += "&lt;/body&gt;&lt;/html&gt;";
  server.send(200, "text/html", html);
}

void handleApiDatos() {
  String json = "{\"temp\":" + String(temperatura, 2) + ",\"hum\":" + String(humedad, 2) + "}";
  server.send(200, "application/json", json);
}</pre>
        </section>
        
        <!-- Seguridad -->
        <section id="seguridad">
            <h2>üîê Seguridad en WiFi IoT</h2>

            <div class="learning-key">
                <h4>üéØ Aprendizaje Clave</h4>
                <p>La seguridad en IoT requiere <strong>no hardcodear credenciales</strong>, usar WPA2 como m√≠nimo, y preferir HTTPS sobre HTTP. Las credenciales deben estar en archivos separados no versionados.</p>
            </div>
            
            <h3>‚ùå Pr√°cticas Inseguras</h3>
            <pre>// Credenciales hardcodeadas
const char* ssid = "MiRedCasa";
const char* password = "ClaveSecreta123";

// HTTP sin cifrar
http.begin("http://api.ejemplo.com/datos");

// API Keys visibles
String url = "?api_key=ABC123XYZ";</pre>
            
            <h3>Niveles de Seguridad WiFi</h3>
            <table>
                <thead>
                    <tr><th>Protocolo</th><th>Seguridad</th></tr>
                </thead>
                <tbody>
                    <tr><td>Abierto</td><td>‚ùå Nunca usar</td></tr>
                    <tr><td>WEP</td><td>‚ùå Obsoleto</td></tr>
                    <tr><td>WPA</td><td>‚ö†Ô∏è Vulnerable</td></tr>
                    <tr><td>WPA2</td><td>‚úÖ Seguro</td></tr>
                    <tr><td>WPA3</td><td>‚úÖ‚úÖ M√°s seguro</td></tr>
                </tbody>
            </table>
            
            <h3>‚úÖ Mejores Pr√°cticas</h3>
            <ul>
                <li><strong>Credenciales en archivo separado:</strong> config.h (no subir a git)</li>
                <li><strong>Usar HTTPS:</strong> cuando sea posible</li>
                <li><strong>API Key en variables de entorno</strong></li>
                <li><strong>WPA2 m√≠nimo:</strong> Configurar router con WPA2 o superior</li>
                <li><strong>Portal de configuraci√≥n:</strong> Crear AP temporal para configurar WiFi sin hardcodear</li>
            </ul>
        </section>
        
        <!-- Energ√≠a -->
        <section id="energia">
            <h2>üîã Modos de Ahorro de Energ√≠a</h2>

            <div class="learning-key">
                <h4>üéØ Aprendizaje Clave</h4>
                <p>El <strong>Deep Sleep</strong> reduce el consumo de 260mA a ~10¬µA, extendiendo la vida de bater√≠as por meses. Ideal para sensores que reportan datos peri√≥dicamente.</p>
            </div>
            
            <table>
                <thead>
                    <tr><th>Modo</th><th>Consumo</th><th>Uso T√≠pico</th></tr>
                </thead>
                <tbody>
                    <tr><td>Activo (transmitiendo)</td><td>160-260 mA</td><td>Streaming de datos</td></tr>
                    <tr><td>Activo (idle)</td><td>80-120 mA</td><td>Servidor web activo</td></tr>
                    <tr><td>Light Sleep</td><td>0.8 mA</td><td>Lecturas peri√≥dicas</td></tr>
                    <tr><td>Deep Sleep</td><td>0.01 mA (10¬µA)</td><td>Reportes horarios</td></tr>
                </tbody>
            </table>
            
            <h3>Ejemplo: Deep Sleep</h3>
            <pre>// Dormir 60 segundos
esp_sleep_enable_timer_wakeup(60 * 1000000);  // 60 segundos en microsegundos
esp_deep_sleep_start();

// Al despertar: reboot completo
// Consumo: ~10 ¬µA durante el sue√±o</pre>
            
            <h3>Calidad de Se√±al (RSSI)</h3>
            <table>
                <thead>
                    <tr><th>RSSI (dBm)</th><th>Calidad</th></tr>
                </thead>
                <tbody>
                    <tr><td>-30 a -60</td><td>Excelente/Muy buena</td></tr>
                    <tr><td>-60 a -70</td><td>Buena</td></tr>
                    <tr><td>-70 a -80</td><td>Regular</td></tr>
                    <tr><td>&lt; -80</td><td>Mala - cambiar ubicaci√≥n</td></tr>
                </tbody>
            </table>
        </section>
        
        <!-- Resumen -->
        <section>
            <h2>üìã Resumen: Funciones Clave WiFi</h2>
            
            <div class="tech-grid">
                <div class="tech-card">
                    <h4>Conexi√≥n y Estado</h4>
                    <ul>
                        <li><code>WiFi.begin(ssid, pass)</code> - Iniciar conexi√≥n</li>
                        <li><code>WiFi.status()</code> - Estado de conexi√≥n</li>
                        <li><code>WiFi.localIP()</code> - IP asignada</li>
                        <li><code>WiFi.RSSI()</code> - Intensidad de se√±al</li>
                        <li><code>WiFi.macAddress()</code> - Direcci√≥n MAC</li>
                    </ul>
                </div>
                <div class="tech-card">
                    <h4>Servidor Web</h4>
                    <ul>
                        <li><code>WebServer server(80)</code> - Crear servidor</li>
                        <li><code>server.on("/", handler)</code> - Definir ruta</li>
                        <li><code>server.send(code, type, content)</code> - Enviar respuesta</li>
                        <li><code>server.handleClient()</code> - Atender peticiones</li>
                        <li><code>server.begin()</code> - Iniciar servidor</li>
                    </ul>
                </div>
                <div class="tech-card">
                    <h4>Cliente HTTP</h4>
                    <ul>
                        <li><code>HTTPClient http</code> - Crear cliente</li>
                        <li><code>http.begin(url)</code> - Configurar URL</li>
                        <li><code>http.GET()</code> - Enviar GET</li>
                        <li><code>http.POST(data)</code> - Enviar POST</li>
                        <li><code>http.getString()</code> - Obtener respuesta</li>
                        <li><code>http.end()</code> - Cerrar conexi√≥n</li>
                    </ul>
                </div>
            </div>
            
            <div class="info-box info">
                <h4>‚û°Ô∏è Pr√≥xima Clase: Protocolos IoT</h4>
                <ul>
                    <li>üì° MQTT: Protocolo publish/subscribe</li>
                    <li>üåê HTTP REST APIs</li>
                    <li>üìä Comparaci√≥n de protocolos IoT</li>
                    <li>üîß Hands-on: MQTT con ESP32</li>
                </ul>
            </div>
        </section>
    </main>
    
    <footer>
        <p><strong>IF0112 - Complementaria II (IoT)</strong> | 6¬∞ Semestre - Ingenier√≠a Inform√°tica</p>
        <p>UNAULA - 2026-I | Generado: 2026-02-01</p>
    </footer>

    <script>
        // ============================================
        // SCROLL PROGRESS & BACK TO TOP
        // ============================================
        (function() {
            'use strict';

            const progressFill = document.getElementById('progressFill');
            const backToTop = document.getElementById('backToTop');

            if (!progressFill || !backToTop) return;

            // Update progress bar and back-to-top visibility
            function updateProgress() {
                const windowHeight = window.innerHeight;
                const documentHeight = document.documentElement.scrollHeight - windowHeight;
                const scrolled = window.scrollY;
                const progress = (scrolled / documentHeight) * 100;

                progressFill.style.width = Math.min(progress, 100) + '%';

                // Show/hide back-to-top button
                if (scrolled > windowHeight * 0.5) {
                    backToTop.classList.add('visible');
                } else {
                    backToTop.classList.remove('visible');
                }
            }

            // Smooth scroll to top
            function scrollToTop() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            }

            // Throttle scroll events for performance
            let ticking = false;
            function onScroll() {
                if (!ticking) {
                    window.requestAnimationFrame(function() {
                        updateProgress();
                        ticking = false;
                    });
                    ticking = true;
                }
            }

            // Event listeners
            window.addEventListener('scroll', onScroll, { passive: true });
            backToTop.addEventListener('click', scrollToTop);

            // Keyboard accessibility for back-to-top
            backToTop.addEventListener('keydown', function(e) {
                if (e.key === 'Enter' || e.key === ' ') {
                    e.preventDefault();
                    scrollToTop();
                }
            });

            // Initial call
            updateProgress();
        })();
    </script>
</body>
</html>
